trait AppTests
{
  def test2015_1_10() = T.command {
    check(runProblem("2015_01_1")(), "280")
    check(runProblem("2015_01_2")(), "1797")

    check(runProblem("2015_02_1")(), "1586300")
    check(runProblem("2015_02_2")(), "3737498")

    check(runProblem("2015_03_1")(), "2592")
    check(runProblem("2015_03_2")(), "2360")

    check(runProblem("2015_04_1")(), "254575")
    check(runProblem("2015_04_2")(), "1038736")

    check(runProblem("2015_05_1")(), "255")
    check(runProblem("2015_05_2")(), "55")

    check(runProblem("2015_06_1")(), "569999")
    check(runProblem("2015_06_2")(), "17836115")

    check(runProblem("2015_07_1")(), "46065")
    check(runProblem("2015_07_2")(), "14134")

    check(runProblem("2015_08_1")(), "1333")
    check(runProblem("2015_08_2")(), "2046")

    check(runProblem("2015_09_1")(), "207")
    check(runProblem("2015_09_2")(), "804")

    check(runProblem("2015_10_1")(), "252594")
    check(runProblem("2015_10_2")(), "3579328")
  }

  def test2015_11_20() = T.command {
    check(runProblem("2015_11_1")(), "hxbxxyzz")
    check(runProblem("2015_11_2")(), "hxcaabcc")
  }

  def test2016_1_10() = T.command {
    check(runProblem("2016_01_1")(), "273")
    check(runProblem("2016_01_2")(), "115")

    check(runProblem("2016_02_1")(), "78293")
    check(runProblem("2016_02_2")(), "AC8C8")

    check(runProblem("2016_03_1")(), "983")
    check(runProblem("2016_03_2")(), "1836")

    check(runProblem("2016_04_1")(), "278221")
    check(runProblem("2016_04_2")(), "267")

    check(runProblem("2016_05_1")(), "4543c154")
    check(runProblem("2016_05_2")(), "1050cbbd")

    check(runProblem("2016_06_1")(), "wkbvmikb")
    check(runProblem("2016_06_2")(), "evakwaga")

    check(runProblem("2016_07_1")(), "118")
    check(runProblem("2016_07_2")(), "260")

    check(runProblem("2016_08_1")(), "110")
    check(runProblem("2016_08_2")(), "ZJHRKCPLYJ")

    check(runProblem("2016_09_1")(), "107035")
    check(runProblem("2016_09_2")(), "11451628995")

    check(runProblem("2016_10_1")(), "161")
    check(runProblem("2016_10_2")(), "133163")
  }

  def test2016_11_20() = T.command {
    check(runProblem("2016_11_1")(), "31")
    check(runProblem("2016_11_2")(), "55")
  }

  def test2017_1_10() = T.command {
    check(runProblem("2017_01_1")(), "1034")
    check(runProblem("2017_01_2")(), "1356")

    check(runProblem("2017_02_1")(), "58975")
    check(runProblem("2017_02_2")(), "308")

    check(runProblem("2017_03_1")(), "438")
    check(runProblem("2017_03_2")(), "266330")

    check(runProblem("2017_04_1")(), "455")
    check(runProblem("2017_04_2")(), "186")

    check(runProblem("2017_05_1")(), "355965")
    check(runProblem("2017_05_2")(), "26948068")

    check(runProblem("2017_06_1")(), "3156")
    check(runProblem("2017_06_2")(), "1610")

    check(runProblem("2017_07_1")(), "dgoocsw")
    check(runProblem("2017_07_2")(), "1275")

    check(runProblem("2017_08_1")(), "5752")
    check(runProblem("2017_08_2")(), "6366")

    check(runProblem("2017_09_1")(), "10800")
    check(runProblem("2017_09_2")(), "4522")

    check(runProblem("2017_10_1")(), "826")
    check(runProblem("2017_10_2")(), "d067d3f14d07e09c2e7308c3926605c4")
  }

  def test2017_11_20() = T.command {
    check(runProblem("2017_11_1")(), "682")
    check(runProblem("2017_11_2")(), "1406")

    check(runProblem("2017_12_1")(), "283")
    check(runProblem("2017_12_2")(), "")
  }

  def test2018_1_10() = T.command {
    check(runProblem("2018_01_1")(), "411")
    check(runProblem("2018_01_2")(), "56360")

    check(runProblem("2018_02_1")(), "5681")
    check(runProblem("2018_02_2")(), "uqyoeizfvmbistpkgnocjtwld")

    check(runProblem("2018_03_1")(), "116491")
    check(runProblem("2018_03_2")(), "707")

    check(runProblem("2018_04_1")(), "39584")
    check(runProblem("2018_04_2")(), "55053")

    check(runProblem("2018_05_1")(), "11242")
    check(runProblem("2018_05_2")(), "5492")

    check(runProblem("2018_06_1")(), "3358")
    check(runProblem("2018_06_2")(), "45909")

    check(runProblem("2018_07_1")(), "GJFMDHNBCIVTUWEQYALSPXZORK")
    check(runProblem("2018_07_2")(), "1050")

    check(runProblem("2018_08_1")(), "47464")
    check(runProblem("2018_08_2")(), "23054")

    check(runProblem("2018_09_1")(), "398730")
    check(runProblem("2018_09_2")(), "3349635509")

    check(runProblem("2018_10_1")(), "FBHKLEAG")
    check(runProblem("2018_10_2")(), "10009")
  }

  def test2018_11_20() = T.command {
    check(runProblem("2018_11_1")(), "34,72")
    check(runProblem("2018_11_2")(), "233,187,13")

    check(runProblem("2018_12_1")(), "1696")
    check(runProblem("2018_12_2")(), "1799999999458")
  }

  def test2019_1_10() = T.command {
    check(runProblem("2019_01_1")(), "3231195")
    check(runProblem("2019_01_2")(), "4843929")

    check(runProblem("2019_02_1")(), "5866663")
    check(runProblem("2019_02_2")(), "4259")

    check(runProblem("2019_03_1")(), "896")
    check(runProblem("2019_03_2")(), "16524")

    check(runProblem("2019_04_1")(), "1169")
    check(runProblem("2019_04_2")(), "757")

    check(runProblem("2019_05_1")(), "13818007")
    check(runProblem("2019_05_2")(), "3176266")

    check(runProblem("2019_06_1")(), "142915")
    check(runProblem("2019_06_2")(), "283")

    check(runProblem("2019_07_1")(), "22012")
    check(runProblem("2019_07_2")(), "4039164")

    check(runProblem("2019_08_1")(), "2480")
    check(runProblem("2019_08_2")(), "ZYBLH")

    check(runProblem("2019_09_1")(), "3100786347")
    check(runProblem("2019_09_2")(), "87023")

    check(runProblem("2019_10_1")(), "303")
    check(runProblem("2019_10_2")(), "408")
  }

  def test2019_11_20() = T.command {
    check(runProblem("2019_11_1")(), "2392")
    check(runProblem("2019_11_2")(), "EGBHLEUE")

    check(runProblem("2019_12_1")(), "11384")
    check(runProblem("2019_12_2")(), "452582583272768")
  }

  def test2020_1_10() = T.command {
    check(runProblem("2020_01_1")(), "744475")
    check(runProblem("2020_01_2")(), "70276940")

    check(runProblem("2020_02_1")(), "460")
    check(runProblem("2020_02_2")(), "251")

    check(runProblem("2020_03_1")(), "262")
    check(runProblem("2020_03_2")(), "2698900776")

    check(runProblem("2020_04_1")(), "256")
    check(runProblem("2020_04_2")(), "198")

    check(runProblem("2020_05_1")(), "866")
    check(runProblem("2020_05_2")(), "583")

    check(runProblem("2020_06_1")(), "6259")
    check(runProblem("2020_06_2")(), "3178")

    check(runProblem("2020_07_1")(), "115")
    check(runProblem("2020_07_2")(), "1250")

    check(runProblem("2020_08_1")(), "1487")
    check(runProblem("2020_08_2")(), "1607")

    check(runProblem("2020_09_1")(), "21806024")
    check(runProblem("2020_09_2")(), "2986195")

    check(runProblem("2020_10_1")(), "2310")
    check(runProblem("2020_10_2")(), "64793042714624")
  }

  def test2020_11_20() = T.command {
    check(runProblem("2020_11_1")(), "2406")
    check(runProblem("2020_11_2")(), "2149")

    check(runProblem("2020_12_1")(), "1838")
    check(runProblem("2020_12_2")(), "89936")
  }

  def testAll() = T.command {
    test2015_1_10()()
    test2015_11_20()()

    test2016_1_10()()
    test2016_11_20()()

    test2017_1_10()()
    test2017_11_20()()

    test2018_1_10()()
    test2018_11_20()()

    test2019_1_10()()
    test2019_11_20()()

    test2020_1_10()()
    test2020_11_20()()
  }

  protected def runProblem(input: String): mill.define.Task[(mill.api.Logger, String, String)]

  private def check(result: (mill.api.Logger, String, String), expected: String): Unit = {
    val (logger, problemId, output) = result
    if (output.trim == expected) {
      logger.info(s"${problemId} OK")
    }
    else {
      logger.error(s"${problemId} FAILED; expected ${expected}; got ${output}")
    }
  }

}

